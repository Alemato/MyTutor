<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title *ngIf="modifica; else titoloinserisci" class="ml--56">{{"MODIFIED_LESSON_TITLE"|translate}}</ion-title>
        <ng-template #titoloinserisci>
            <ion-title class="ml--56">{{"INSERTION_LESSON_TITLE"|translate}}</ion-title>
        </ng-template>
    </ion-toolbar>
</ion-header>


<ion-content>
    <div>
        <form [formGroup]="lezioneFormModel">
            <ion-item class="ion-no-padding" style="margin-top: 5px">
                <ion-label class="ion-padding-start">{{"SUBJECT"|translate}}:</ion-label>
                <ion-label color="primary"> {{materia}}</ion-label>
                <ion-button slot="end" fill="clear" (click)="showPicker()">{{"SELECT_BUTTON"|translate}}</ion-button>
            </ion-item>
            <div *ngIf="materia !== 'Creane una'">
                <ion-item *ngIf="uscitaValue!==null; else selctDisabilited">
                    <ion-label>{{"SUB_SUBJECT"|translate}}:</ion-label>
                    <ion-select okText="{{'SELECT_BUTTON'|translate}}" formControlName="sottoMateria" cancelText="{{'CANCEL_BUTTON'|translate}}"
                                style="width: 65%; max-width: 65%;">
                        <ion-select-option *ngFor="let sot of sottoMaterie[uscitaValue]"
                                           value="{{sot.value}}">{{sot.text}}</ion-select-option>
                    </ion-select>
                </ion-item>
            </div>
            <div *ngIf="materia === 'Creane una'">
                <ion-item class="ion-no-padding">
                    <ion-label style="padding-left: 18px!important;">{{"NEW_SUBJECT"|translate}}</ion-label>
                    <ion-input type="text" formControlName="nuovaMateria"
                               required style="padding-left: 18px!important;"></ion-input>
                </ion-item>
                <ion-item class="ion-no-padding">
                    <ion-label style="padding-left: 18px!important;">{{"NEW_SUB_SUBJECT"|translate}}</ion-label>
                    <ion-input type="text" formControlName="nuovaSottoMateria"
                               required style="padding-left: 18px!important;"></ion-input>
                </ion-item>
            </div>
            <ng-template #selctDisabilitedOrModifica>
                <div *ngIf="booleanSottomateria; else selctDisabilited">
                <ion-item>
                    <ion-label>{{"SUB_SUBJECT"|translate}}:</ion-label>
                    <ion-select okText="{{'SELECT_BUTTON'|translate}}" cancelText="{{'CANCEL_BUTTON'|translate}}" formControlName="sottoMateria" style="width: 65%; max-width: 65%;"
                                placeholder="{{'SUB_SUBJECT_SELECT'|translate}}">
                        <ion-select-option value="{{this.lesson.subject.microSubject}}">{{this.lesson.subject.microSubject}}</ion-select-option>
                    </ion-select>
                </ion-item>
                </div>
            </ng-template>
            <ng-template #selctDisabilited>
                <ion-item>
                    <ion-label>{{"SUB_SUBJECT"|translate}}:</ion-label>
                    <ion-select okText="{{'SELECT_BUTTON'|translate}}" cancelText="{{'CANCEL_BUTTON'|translate}}" style="width: 65%; max-width: 65%;" disabled
                                placeholder="{{'SUB_SUBJECT_SELECT'|translate}}">
                        <ion-select-option value="0">{{"ALL"|translate}}</ion-select-option>
                    </ion-select>
                </ion-item>
            </ng-template>
            <ion-item class="ion-no-padding">
                <ion-label style="padding-left: 18px!important;">{{"NAME_LESSON"|translate}}</ion-label>
                <ion-input type="text" formControlName="nomeLezione"
                           required style="padding-left: 18px!important; "></ion-input>
            </ion-item>
            <ion-item class="ion-no-padding">
                <ion-label style="padding-left: 18px!important;">{{"PRICE_HOUR"|translate}}:</ion-label>
                <ion-input formControlName="prezzoOrario" type="number" placeholder="00,00"
                           required style="padding-left: 18px!important;"></ion-input>
            </ion-item>
            <ion-item class="ion-no-padding">
                <ion-button style="margin-left: auto!important; margin-right: auto!important;"
                            (click)="notificaCondizione()">{{"DATE_TIME_BUTTON"|translate}}
                </ion-button>
            </ion-item>
            <ion-item class="ion-no-padding">
                <ion-textarea style="padding-left: 18px!important;" formControlName="descrizione"
                              placeholder="{{'DESCRIPTION_LESSON_TEXTAREA'|translate}}" required></ion-textarea>
            </ion-item>
        </form>
    </div>
    <div class="mt-15">
        <ion-list-header class="text-bolder fs-large fw-normal c-primary">{{"PLANNING_LIST_LD"|translate}}</ion-list-header>
        <div *ngIf="planningVisualizzazione.length > 0; else modificaLessonOrNoPlannings">
            <ion-list  *ngFor="let planning of planningVisualizzazione; let i = index;">
                <ion-item>
                    <ion-icon name="remove-circle-outline" (click)="rimuoviPlanning(i)"></ion-icon>
                    <ion-col size="5">
                        {{planning.date}}
                    </ion-col>
                    <ion-col size="3">
                        {{planning.startTime}}
                    </ion-col>
                    <ion-col size="3">
                        {{planning.endTime}}
                    </ion-col>
                </ion-item>
            </ion-list>
        </div>
        <ng-template #modificaLessonOrNoPlannings>
            <div *ngIf="booleanSottomateria; else noPlannings" class="mx-auto fit-content testo-centrato">
                <h6>{{"PLANNING_TEXT"|translate}}</h6>
                <h6>{{"DATE_TIME_BUTTON"|translate}}</h6>
            </div>
        </ng-template>
        <ng-template #noPlannings>
            <div class="mx-auto fit-content testo-centrato">
                <h6> {{"ANY_PLANNING_INSERTED"|translate}}</h6>
                <h6> {{"CLICK_ON_SET_DATE_TIME"|translate}}</h6>
            </div>
        </ng-template>
    </div>
    <div class="bottone-inserisci" *ngIf="modifica; else bottoneInserisci">
        <ion-button expand="full" class="submit-btn ion-margin-bottom ion-margin-top" (click)="modificaLezione()"
                    [disabled]="!lezioneFormModel.valid || !this.ok">{{"MODIFIED"}}
        </ion-button>
    </div>
    <ng-template #bottoneInserisci>
        <div class="bottone-inserisci">
            <ion-button expand="full" class="submit-btn ion-margin-bottom ion-margin-top" (click)="inserisciLezione()"
                        [disabled]="!lezioneFormModel.valid || !this.ok">{{"INSERT_BUTTON"|translate}}
            </ion-button>
        </div>
    </ng-template>
</ion-content>
